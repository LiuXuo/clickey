# Clickey

用键盘把鼠标“投送”到屏幕任意位置：按下热键 → 看到全屏网格遮罩 → 连续按几下键把区域逐层缩小 → 自动移动并点击目标点。

> 当前仓库阶段：**文档先行 + AHK 行为原型**。正式产品计划落地为 **Tauri + Rust + Svelte** 的跨平台桌面应用（Windows/macOS/Linux\*）。

---

## 这是什么 / 解决什么问题

Clickey 的目标是提供一种高效、精确、可肌肉记忆的鼠标定位方式：

- **不离开键盘**：用固定键位序列完成“移动 + 点击”。
- **精确可控**：通过“分层网格裁剪”逐步缩小选择区域。
- **跨平台一致**：最终用 Web 技术统一 UI，Rust 只负责系统能力。

典型使用场景：

- IDE/浏览器里频繁点小按钮、标签页、面板折叠箭头
- 多显示器 + 高 DPI 下，鼠标移动成本很高
- 录屏演示/讲解时，需要“可预测”的鼠标轨迹与落点

---

## 演示（当前用 AHK 原型体验）

仓库里有两套可运行的 AutoHotkey（AHK v1）行为原型：

- `clickey.ahk`：偏“少按键、分层更多”的 **3x3** 方案
- `clickeyy.ahk`：偏“定位更细、键位更密”的 **5x5** 方案

它们用于验证交互与算法（撤销/取消/直达点击、多显示器虚拟屏坐标、DPI 缩放、遮罩绘制等）。

---

## 快速开始（Windows / AHK 原型）

1. 安装 AutoHotkey **v1.1**（这两份脚本是 AHK v1 语法）。
2. 双击运行脚本：
   - 运行 `clickey.ahk`（3x3 原型），或
   - 运行 `clickeyy.ahk`（5x5 原型）
3. 按热键进入选择模式，按键完成定位；结束后会移动鼠标到目标区域中心并点击。

退出脚本：任务栏托盘图标右键退出（或在 AHK 的脚本管理里退出）。

---

## 快捷键（原型行为）

两套原型的核心交互一致：

| 操作                                 | 快捷键 / 按键            |
| ------------------------------------ | ------------------------ |
| 激活并左键点击                       | `Ctrl + ;`               |
| 激活并右键点击                       | `Ctrl + Shift + ;`       |
| 激活并中键点击                       | `Ctrl + Shift + Alt + ;` |
| 取消并退出                           | `Esc`                    |
| 回退一步（撤销上一按键）             | `Backspace`              |
| 直接点击当前区域中心（跳过后续层级） | `Space`                  |

额外调试（仅 3x3 原型提供）：

- `Ctrl + Alt + D`：显示屏幕/DPI/虚拟屏范围信息（便于排查多显示器与缩放问题）

---

## 它是怎么工作的（分层网格裁剪）

### 基本概念

- **Region（区域）**：当前可选范围（初始是“虚拟屏幕”范围）。
- **Grid（网格）**：把 Region 切成 `rows x cols` 个格子。
- **Key（按键）**：每个格子对应一个键；按下键就选中对应格子，Region 收缩到该格子。
- 重复上述过程，直到达到你希望的精度，然后点击 Region 中心点。

### 3x3 原型（`clickey.ahk`）

键位分两组：

- 行键（9 个）：`w e r / s d f / x c v`
- 列键（9 个）：`u i o / j k l / m , .`

流程（按键次数更多，但每一步键位更少、更好记）：

1. combo 第 1 步：按“行键”选一个 3x3 大块
2. combo 第 2 步：按“列键”在大块内再选 3x3
3. single：再用行键做一次 3x3 精细裁剪
4. single：再用列键做一次 3x3 精细裁剪

### 5x5 原型（`clickeyy.ahk`）

键位为 5x5：

`q w e r t`  
`y u i o p`  
`a s d f g`  
`h j k l ;`  
`z x c v b`

流程（按键更少，但键位密度更高）：

1. combo 第 1 步：5x5 选块
2. combo 第 2 步：块内 5x5 再选一次
3. single：再 5x5 精细裁剪一次，然后点击

---

## 与 AHK 原型的关系（以及接下来的产品形态）

AHK 原型负责回答“交互是否成立、算法是否准确、遮罩是否可用”：

- 激活/取消/回退/直达点击是否顺手
- 多显示器“虚拟屏幕坐标”是否准确
- DPI 缩放下遮罩线条/文字是否对齐
- 点击落点是否稳定（区域中心点）

正式版本计划演进为：

- **Core Engine（TypeScript）**：纯逻辑、可单测的状态机与区域裁剪算法
- **Native Layer（Rust / Tauri）**：全局热键、鼠标控制、屏幕与 DPI 信息
- **UI（Svelte）**：两类 WebView
  - **Overlay（遮罩渲染）**：全屏透明、click-through、不抢焦点（Canvas/SVG）
  - **Settings（设置页）**：普通可交互窗口，用于预设/配置管理

---

## 路线图（高层）

更细的执行细节与任务拆分统一收敛在 `AGENT.md`，这里只保留“对人类友好”的里程碑视图：

1. **M0：原型验证**（已具备）
   - AHK 原型可用（3x3 / 5x5）
   - 交互闭环：热键 → 遮罩 → 定位 → 点击
2. **M1：核心引擎抽象**
   - 把“区域裁剪 + 状态机 + undo”抽成可测试的 TS Core
3. **M2：桌面壳与原生能力**
   - Tauri 项目初始化
   - Rust：热键/鼠标/屏幕信息（Windows 优先）
4. **M3：遮罩与配置 UI**
   - 透明遮罩窗口
   - 配置持久化、预设管理
   - 托盘菜单 + 设置页（WebView）联动
5. **M4：跨平台与发布**
   - macOS 权限与适配
   - Linux（X11 优先，Wayland 功能受限）

---

## 设置页与托盘（规划）

除“遮罩定位 + 点击”本体外，正式版本会提供一个 **托盘（system tray）入口**，用于“轻量控制”和“打开设置”：

- **托盘右键菜单**：唤出（或切换显示）一个用 **WebView 绘制**的设置页面。
- **设置页面**：用于管理预设与高度定制化配置（不要求用户改代码）。

可定制项（方向）：

- **交互热键**：激活热键（左/右/中键点击）与控制键（取消/回退/直达）。
- **预设（Presets）**：内置 3x3/5x5 方案 + 用户自定义方案；可切换当前启用的预设。
- **分层与网格**：每个预设由一组 `layers` 组成；每层可定义行列数（`rows x cols`）与模式（`single` / `combo`）。
- **按键映射**：每个（子）步骤都有自己的 `keys` 列表，决定 `keyIndex → row/col` 的映射。
- **遮罩外观**：透明度、线条颜色/粗细、文字颜色/字号等。

字段名约定（与 `AGENT.md` 的配置模型一致）：

- 激活热键：`hotkeys.activation.leftClick` / `hotkeys.activation.rightClick` / `hotkeys.activation.middleClick`
- 控制键：`hotkeys.controls.cancel` / `hotkeys.controls.undo` / `hotkeys.controls.directClick`
- 当前启用预设：`activePresetId`
- 预设列表：`presets[]`（每个 preset 里包含 `layers[]`）
- 遮罩外观：`overlay.*`

核心原则：

- **配置是单一事实来源**：设置页只编辑配置；不把业务状态“塞在 UI 里”。
- **操作解耦**：热键监听、区域裁剪（Core Engine）、遮罩渲染（Overlay）、鼠标执行（Native）彼此独立，才能支持高程度的定制化与后续扩展。

## 贡献（当前阶段）

目前更需要的是“把行为规格写清楚、把边界约束定死”，而不是堆功能：

- 交互细节（撤销、取消、直达点击）是否需要扩展
- 默认网格方案选择（3x3 vs 5x5，是否支持自定义）
- 目标平台优先级（Windows 优先 / 多平台并行）

如果你要让大模型接力开发/维护，请先阅读 `AGENT.md`。

---

## License

MIT（见 `LICENSE`）。
